# ExCenterPivotView

`ExCenterPivotView`는 트레이딩 화면의 중심에 위치하는 주요 UI 컴포넌트입니다. 현재 선택된 종목의 주요 정보(현재가, 변동률, 거래량 등)와 연동된 위젯들을 표시하고, 사용자 인터랙션의 중심 역할을 합니다.

***

## 기능

* 현재 선택 종목의 핵심 정보 표시
* 실시간 시세 갱신
* 종목 변경 기능 지원
* 타 위젯과의 상태 동기화
* 종목 검색 및 변경 기능
* 테마(다크/라이트) 변경 지원

***

## 주요 구성 요소

| UI 요소    | 설명                     |
| -------- | ---------------------- |
| 종목 이름    | 현재 선택된 종목 표시           |
| 현재가      | 실시간 현재가 표시             |
| 전일 대비    | 등락률, 전일 대비 금액          |
| 거래량      | 24시간 거래량 표시            |
| 시가/고가/저가 | 시가, 고가, 저가 표시          |
| 종목 검색창   | 사용자가 종목을 검색 및 선택할 수 있음 |
| 상태 아이콘   | 현재 연결 상태, 데이터 수신 상태 표시 |

***

## 클래스 메서드

### 초기화 관련

#### init(context, evtListener)

* 뷰 초기화
* 초기 상태 설정
* 이벤트 리스너 바인딩

#### setMarket(market)

* 현재 표시할 종목 설정
* 변경 시 자동으로 관련 데이터 업데이트

### 데이터 동기화

#### subscribe()

* 현재 market에 대한 실시간 데이터 수신 시작

#### unsubscribe()

* 현재 market에 대한 실시간 데이터 수신 중단

#### updateTicker(tickerData)

* 실시간 현재가 정보 업데이트
* price, change\_rate, change\_price 등 반영

#### updateSummary(summaryData)

* 거래량, 시가, 고가, 저가 등 보조 데이터 업데이트

### UI 관련

#### applyTheme(theme)

* 테마 적용 (`dark` 또는 `light`)

#### highlight()

* 주요 가격 변동 시 강조 효과

#### reset()

* UI 상태 초기화 및 데이터 클리어

***

## 데이터 구조

### WebSocket ticker 데이터 예시

```json
{
  "type": "ticker",
  "code": "KRW-BTC",
  "trade_price": 45500000,
  "change_rate": 0.0215,
  "change_price": 960000,
  "signed_change_price": 960000,
  "acc_trade_volume_24h": 25.32,
  "high_price": 47000000,
  "low_price": 45000000,
  "opening_price": 45200000,
  "timestamp": 1656789123456
}
```

***

## UI 구조 예시

```
┌─────────────────────────────────────┐
│   [ 종목명 ]  KRW-BTC                │
│─────────────────────────────────────│
│   현재가      45,500,000 KRW         │
│   전일대비    +960,000 (+2.15%)      │
│─────────────────────────────────────│
│   시가   45,200,000                  │
│   고가   47,000,000                  │
│   저가   45,000,000                  │
│─────────────────────────────────────│
│   거래량  25.32 BTC                  │
│─────────────────────────────────────│
│   [ 검색 ] BTC 입력 시 자동완성      │
└─────────────────────────────────────┘
```

***

## 이벤트 및 콜백

| 이벤트 이름                   | 설명                       |
| ------------------------ | ------------------------ |
| onMarketChanged(market)  | 사용자가 종목을 변경했을 때          |
| onTickerUpdate(ticker)   | 실시간 현재가 데이터 수신 시         |
| onSummaryUpdate(summary) | 거래량, 시가, 고가, 저가 데이터 갱신 시 |

***

## 설정 옵션

| 옵션            | 설명                  | 기본값  |
| ------------- | ------------------- | ---- |
| autoHighlight | 가격 변동 시 자동 하이라이트 여부 | true |
| enableSearch  | 종목 검색창 활성화 여부       | true |
| showSummary   | 시가/고가/저가/거래량 표시 여부  | true |

***

## 사용 예제

```javascript
const pivot = new ExCenterPivotView();

pivot.setMarket('KRW-BTC');
pivot.subscribe();

// 특정 테마 적용
pivot.applyTheme('dark');

// 현재가 하이라이트
pivot.highlight();
```

***

## 오류 처리 및 예외

* WebSocket 데이터 미수신 시 `reset()` 자동 호출 가능
* 종목 코드 오류 시 내부적으로 `onMarketChanged()` 재호출 요청
* 네트워크 장애 시 재연결 로직 포함

***

## 초기화 및 종료 순서

1. `setMarket()`으로 종목 설정
2. `subscribe()` 호출하여 데이터 수신 시작
3. 종료 시 `unsubscribe()` 호출하여 데이터 수신 해제
